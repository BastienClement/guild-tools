<dom-module id="gt-app">
	<style type="text/less">
		:host {
			.cover;
			z-index: 500;
			min-width: 1200px;
		}

		#title { .gpu;
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			height: 56px;
			z-index: 10;
			
			&[is_app] {
				top: 1px;
				left: 1px;
				right: 1px;
			}
		}

		#side { .gpu;
			position: absolute;
			top: 56px;
			left: 0;
			bottom: 0;
			width: 56px;
			z-index: 5;
			
			&[is_app] {
				top: 57px;
				left: 1px;
				bottom: 1px;
			}
		}

		#view {
			position: absolute;
			top: 56px;
			left: 56px + 12px;
			right: 0;
			bottom: 0;
			z-index: 15;
			
			&[is_app] {
				top: 57px;
				left: 56px + 12px + 1px;
				right: 1px;
				bottom: 1px;
			}
		}
	</style>
	<template>
		<gt-title-bar #title {is_app}></gt-title-bar>
		<gt-sidebar #side {is_app}></gt-sidebar>
		<gt-view #view (scroll)="ViewScroll" {is_app}></gt-view>
	</template>
</dom-module>

<!-- ////////////////////////////////////////////////////////////////////// -->

<dom-module id="gt-title-bar">
	<style type="text/less">
		@titlebar-height: 64px;
		
		// Loader animation settings
		@offset: 187;
		@duration: 1.4s;

		:host {
			padding: 12px;
			box-sizing: border-box;
			animation: slide 0.5s ease-out;
			animation-fill-mode: both;

			background: fade(@fs-blue, 15%);
			//background: fade(mix(rgb(55, 74, 93), @fs-blue, 90%), 70%);
			box-shadow: 0px 1px 2px rgba(17, 17, 17, 0.15);

			display: flex;
			align-items: center;
			
			-webkit-app-region: drag;
		}
		
		:host > * {
			-webkit-app-region: no-drag;
		}

		#logo {
			height: 56px;
			width: 56px;
			overflow: hidden;
			
			position: absolute;
			top: 0px;
			left: 0px;
			z-index: 200;

			padding: 12px;

			background: fade(@fs-blue, 15%);
			//background: rgba(65, 100, 132, 0.90);
			transition: all .2s ease-out;

			&:hover {
				background: fade(@fs-blue, 25%);
			}

			@panel-width: 220px;
			@panel-height: 525px;

			:host([panel]) & {
				background: rgba(65, 100, 132, 0.98);
				width: @panel-width;
				height: @panel-height;
				box-shadow: 1px 1px 15px rgba(17, 17, 17, 0.3);
				border-left: 0;
				border-top: 0;
				top: 4px;
				left: 4px;
				
				#panel {
					opacity: 1;
				}
			}
			
			#panel {
				position: absolute;
				top: 0;
				left: 0;
				width: @panel-width;
				height: @panel-height;
				opacity: 0;
				//transition: all .25s ease-out;
				display: flex;
				flex-direction: column;
				
				h1 {
					font-size: 18px;
					font-family: "Roboto Condensed";
					font-weight: 400;
					margin: 0;
					padding: 17px 8px 17px 44px;
					text-align: center;
					border-bottom: 2px solid fade(@fs-blue, 50%);
				}
				
				gt-button {
					padding: 0px 12px;
					margin: 0;
					font-weight: 400;
					justify-content: flex-start;
					border-bottom: 1px solid fade(@fs-blue, 20%);
					background-clip: padding-box;
					height: 45px;
					color: #fff;
					transition: all .25s ease-out;
					
					i {
						margin-right: 15px;
					}
					
					&:hover {
						background-color: fade(@fs-blue, 10%);
					}
				}
			}
			
			img {
				height: 32px;
				width: 32px;
				opacity: 1;
				transition: opacity .25s ease-out;
			}
			
			svg {
				position: absolute;
				top: 14px;
				left: 16px;
				width: 24px;
				height: 24px;
				animation: rotator @duration linear infinite;
				display: none;
				
				circle {
					stroke-dasharray: @offset;
					stroke-dashoffset: 0;
					transform-origin: center;
					stroke: #fff;
					animation: dash @duration ease-in-out infinite;
				}
			}
			
			&[loading] {
				& img { opacity: .2; }
				& svg { display: block; }
			}
			
			#credits {
				position: absolute;
				bottom: 15px;
				left: 0px;
				right: 0px;
				text-align: center;
				color: mix(@fs-blue, white, 50%);
				text-shadow: none;
				font-weight: 400;
				font-size: 11px;
				
				em {
					font-style: italic;
				}
			}
		}
		
		@keyframes rotator {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(270deg); }
		}
		
		@keyframes dash {
			0% { stroke-dashoffset: @offset; }
			50% {
				stroke-dashoffset: @offset/4;
				transform: rotate(135deg);
			}
			100% {
				stroke-dashoffset: @offset;
				transform: rotate(450deg);
			}
		}

		#tabs {
			flex: 1;
			-webkit-app-region: drag;
			margin-left: 48px;
			
			& >* {
				-webkit-app-region: no-drag;
			}
		}

		#tabs gt-button {
			transition: opacity .25s ease-out, color .25s ease-out;
			height: 56px;

			opacity: 0.8;
			color: mix(@light-blue, white, 50%);

			&:hover, &[active] {
				opacity: 1;
				color: white;
			}
			
			&[active] {
				border-top: 2px solid transparent;
				border-bottom: 2px solid fade(@fs-blue, 50%);
			}
		}

		#chat {
			font-size: 15px;

			& > div {
				display: inline-block;
			}
		}

		i {
			font-size: 20px;
		}

		#status, #online {
			margin-right: 8px;
		}

		#latency {
			margin-right: 4px;
		}

		#window-controls {
			margin-left: 16px;
			margin-right: 5px;

			i {
				margin-left: 8px;
				transition: text-shadow .3s ease-out;
				
				&:hover {
					text-shadow: 0px 0px 5px rgba(255, 255, 255, 0.8);
				}
			}
		}

		@keyframes slide {
			0% { transform: translateY(-5px); opacity: 0; }
			100% { transform: translateY(0); opacity: 1; }
		}
	</style>
	<template>
		<div #logo {loading}>
			<img src="/assets/images/logo_small2.png">
			<svg width="32px" height="32px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
				<circle fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
			</svg>
			<div #panel>
				<h1>GuildTools</h1>
				<gt-button goto="/about"><i>info_outline</i> About</gt-button>
				<gt-button goto="/settings"><i>settings</i> Settings</gt-button>
				<gt-button (click)="Reload"><i>refresh</i> Reload</gt-button>
				<gt-button (click)="DownloadClient"><i>file_download</i> Download client</gt-button>
				<gt-button (click)="DevTools"><i>build</i> Developer Tools</gt-button>
				<gt-button goto="/server-status"><i>swap_horiz</i> Server status</gt-button>
				<gt-button (click)="Logout"><i>exit_to_app</i> Logout</gt-button>
				<gt-button (click)="Quit" {hidden}="!app.standalone"><i>close</i> Quit</gt-button>
				<div #credits>
					From Scratch GuildTools<br>
					<em>Awesomeness Reloaded&trade;</em>
				</div>
			</div>
		</div>
		<div #tabs>
			<gt-button [repeat]="tabs" collapse-left {active}="item.active" [goto]="item.link">{{item.title}}</gt-button>
		</div>
		<div #chat>
			<div #status>
				<b>Blash</b>
				<i>arrow_drop_down</i>
			</div>
			<div #online>
				<i>person_outline</i>
				<b>{{online_users}}</b>
			</div>
		<div>
		<div #window-controls>
			<i #window-minimize>remove</i>
			<i #window-close>close</i>
		</div>
	</template>
</dom-module>

<!-- ////////////////////////////////////////////////////////////////////// -->

<dom-module id="gt-sidebar">
	<style type="text/less">
		:host {
			padding-top: 12px;
			animation: sidebar-appear 0.3s ease-out;
			animation-delay: 0.5s;
			animation-fill-mode: both;
			box-shadow: 0px 1px 2px rgba(17, 17, 17, 0.15);
		}
		
		@keyframes sidebar-appear {
			0% { background: fade(@fs-blue, 0%); }
			100% { background: fade(@fs-blue, 8%); }
			//0% { background: rgba(51, 66, 80, 0); }
			//100% { background: rgba(51, 66, 80, 1); }
		}
		
		.generate-icn-delay(@nth) when (@nth < 20) {
			.icon:nth-child(@{nth}) { animation-delay: unit((@nth - 1) * 0.1, s); }
			.generate-icn-delay(@nth + 1);
		}

		.generate-icn-delay(1);

		.icon {
			font-size: 32px;
			padding: 4px 6px;
			color: @fs-blue;
			position: relative;
			cursor: default;

			animation: slide-in 0.4s ease-out;
			animation-fill-mode: both;
			
			i {
				padding: 5px 5px;
				display: inline-block;
				box-sizing: content-box;
				border: 1px solid transparent;
				transition: all 0.2s ease-out;
			}

			&:hover i {
				background: fade(@fs-blue, 8%);
				border-color: fade(@fs-blue, 10%);
			}

			&[active] i {
				background: fade(@fs-blue, 15%);
				border-color: fade(@fs-blue, 20%);
			}
		}

		@keyframes slide-in {
			0% { transform: translateX(-10px); opacity: 0; }
			100% { transform: translateX(0px); opacity: 1; }
		}
	</style>
	<template>
		<div .icon [repeat]="icons" (click)="IconClicked" {active}="equals(item.key, module)"><i>{{item.icon}}</i></div>
	</template>
</dom-module>

<!-- ////////////////////////////////////////////////////////////////////// -->

<dom-module id="gt-view">
	<style type="text/less">
		:host {
			overflow: visible;
		}

		#wrapper {
			.pos(absolute, 12px, 12px, 12px, 0);
		}

		#wrapper ::content > * {
			position: absolute;
			top: 0px;
			right: 0px;
			bottom: 0px;
			left: 0px;
			
			margin: auto;

			opacity: 0;
			transition: opacity 0.3s ease-in;

			&.active {
				opacity: 1;
			}
		}
	</style>
	<template>
		<div #wrapper>
			<content></content>
		</div>
	</template>
</dom-module>
