<dom-module id="gt-dashboard">
	<style type="text/less">
		#layout {
			height: 100%;
			width: 100%;
			display: grid;
			grid-template-columns: 1fr 6px 1.7fr 6px 300px;
			grid-template-rows: 100%;
		}

		.col {
			width: 100%;
			height: 100%;
			gt-box:not(:last-child) {
				margin-bottom: 6px;
			}
		}

		#col1 {
			grid-column: 1;

			dashboard-news {
				height: 100%;
			}
		}

		#col2 {
			grid-column: 3;
			
			display: grid;
			grid-template-columns: 100%;
			grid-template-rows: 200px 6px 1fr;
			
			& > * {
				height: 100%;
			}

			#activity {
				grid-row: 1;
			}
			
			#shoutbox {
				grid-row: 3;
			}
		}

		#col3 {
			grid-column: 5;
			
			display: grid;
			grid-template-columns: 100%;
			grid-template-rows: auto 6px auto 6px 1fr;
			
			& > * {
				height: 100%;
			}

			#profile {
				grid-row: 1;
			}
			
			#informations {
				grid-row: 3;
			}

			#onlines {
				grid-row: 5;
			}
		}
	</style>
	<template>
		<div #layout>
			<div .col #col1>
				<dashboard-news></dashboard-news>
			</div>
			<div .col #col2>
				<gt-box #activity heading="Guild activity" scrollable>
					<div style="position: absolute; top: 60px; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; font-size: 60px;">
						<i>build</i>
					</div>
				</gt-box>
				<dashboard-shoutbox #shoutbox></dashboard-shoutbox>
			</div>
			<div .col #col3>
				<gt-box #profile>Blash</gt-box>
				<gt-box #informations heading="Informations"></gt-box>
				<dashboard-onlines #onlines></dashboard-onlines>
			</div>
		</div>
	</template>
</dom-module>

<dom-module id="dashboard-news">
	<style type="text/less">
		:host {
			display: block;
		}

		#feed {
			height: 100%;
		}

		#actions {
			position: absolute;
			top: 16px;
			right: 16px;
			line-height: 24px;
		}
		
		#disconnected {
			position: absolute;
			top: 16px;
			left: 130px;
			line-height: 24px;
			font-size: 18px;
			color: @light-blue;
		}

		#list {
			margin-bottom: -6px;
		}

		.news {
			height: 0px;
			opacity: 0;

			display: flex;
			transition: all .2s ease-out;

			&:hover {
				background-color: fade(@fs-blue, 10%);
			}

			&[visible] {
				height: 25px;
				opacity: 1;

				padding: 3px 5px;
				margin: 0 -10px 0 -5px;
			}

			img {
				height: 15px;
				margin-right: 10px;
			}

			b {
				flex: 1;
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;

				&[source=MMO] {
					color: #90E055;
				}

				&[tags*=BLIZZ] {
					color: #00B4FF;
				}
			}

			gt-timeago {
				color: @light-blue;
				margin-left: 12px;
			}
		}
	</style>
	<template>
		<gt-box #feed heading="News Feed" scrollable>
			<div #disconnected {hidden}="available">
				<i>cloud_off</i>
			</div>
			<div #actions>
				<dashboard-news-filter key="MMO" [active]="filters.MMO"></dashboard-news-filter>
				<dashboard-news-filter key="BLUE" [active]="filters.BLUE"></dashboard-news-filter>
				<dashboard-news-filter key="WOW" [active]="filters.WOW"></dashboard-news-filter>
			</div>
			<gt-alert #none {hidden}="!noVisible" icon="cloud_off">
				No news to display.<br>
				The news feed may be temporarily unavailable.
			</gt-alert>
			<div #list>
				<div .news [repeat]="news" {visible}="visible(item.source, filters.*)" (click)="open">
					<img [src]="icon(item)">
					<b {tags}="item.tags" {source}="item.source">{{item.title}}</b>
					<gt-timeago [date]="item.time"></gt-timeago>
				</div>
			</div>
		</gt-box>
	</template>
</dom-module>

<dom-module id="dashboard-news-filter">
	<style type="text/less">
		gt-button {
			padding: 0;
			height: auto;
			padding-bottom: 4px;
			border-bottom: 2px solid transparent;
			opacity: .5;
			transition: border .2s ease-out, opacity .2s ease-out;

			&[active] {
				opacity: 1;
				border-bottom-color: @fs-blue;
			}
		}
	</style>
	<template>
		<gt-button {active}><img [src]="icon"></gt-button>
	</template>
</dom-module>

<dom-module id="dashboard-shoutbox">
	<style type="text/less">
		gt-box {
			height: 100%;
		}
	</style>
	<template>
		<gt-box #shoutbox heading="Shoutbox" scrollable>
			<div style="position: absolute; top: 60px; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; font-size: 80px;">
				<i>build</i>
			</div>
			<!--<div .message [repeat]="messages">
				<span .left>
					<gt-timeago .time [date]="item.date"></gt-timeago>
					<span .actions>
					</span>
				</span>
				<span .author>{{item.author}}</span>
				<span .message>{{item.message}}</span>
			</div>-->
		</gt-box>
	</template>
</dom-module>

<dom-module id="dashboard-onlines">
	<style type="text/less">
		gt-box {
			height: 100%;
		}
		
		dashboard-onlines-user {
			margin: 6px 0px;
		}
	</style>
	<template>
		<gt-box #onlines heading="Onlines" scrollable>
			<dashboard-onlines-user [user]="item" [repeat]="onlines"></dashboard-onlines-user>
		</gt-box>
	</template>
</dom-module>

<dom-module id="dashboard-onlines-user">
	<style type="text/less">
		@size: 40px;
		@radius: 10px;
	
		:host {
			display: block;
		}
		
		#layout {
			display: flex;
			align-items: center;
			background: fade(@fs-blue, 10%);
			border: 1px solid fade(@fs-blue, 10%);
			transition: all .2s ease-out;
			
			&:hover {
				background: fade(@fs-blue, 12%);
				border-color: fade(@fs-blue, 20%);
			}
		}
		
		#name {
			flex: 1;
			padding: 10px;
		}
		
		#state-container {
			background: rgba(17, 17, 17, 0.1);
			background-clip: padding-box;
			border: 1px solid fade(@fs-blue, 10%);
			border-width: 0 1px 0 1px;
			height: @size;
			padding: (@size - @radius) / 2;
			margin-left: 10px;
		}
		
		#state {
			height: @radius;
			width: @radius;
			border-radius: @radius;
			background: #41c32b;
			transition: background .2s ease-out;
			
			[away] & {
				background: #f4d736;
			}
		}
		
		bnet-thumb {
			width: @size;
			height: @size;
			transition: opacity .2s ease-out;
			
			[away] & {
				opacity: .5;
			}
		}
	</style>
	<template>
		<div #layout {away}>
			<b #name>{{main.name}}</b>
			<div #state-container>
				<div #state></div>
			</div>
			<bnet-thumb [char]="main"></bnet-thumb>
		</div>
	</template>
</dom-module>
